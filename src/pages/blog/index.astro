---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CTASection from '../../components/CTASection.astro';
import { blogPosts, getCategories } from '../../data/blogPosts';

const categories = ['All', ...getCategories()];

const schema = {
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Search Engine Coach Blog",
  "description": "Expert SEO insights, guides, and strategies to help businesses rank higher and grow.",
  "url": "https://searchenginecoach.com/blog/"
};
---

<BaseLayout
  title="SEO Blog | Expert Tips & Strategies | Search Engine Coach"
  description="Learn SEO strategies that work. Expert guides on local SEO, technical optimization, content strategy, and more to help your business rank higher."
  canonicalUrl="/blog/"
  schema={schema}
>
  <!-- Hero -->
  <section class="blog-hero">
    <div class="container">
      <h1>SEO Insights & Strategies</h1>
      <p class="blog-hero-subtitle">
        Expert guides and actionable advice to help your business rank higher on Google, 
        drive more traffic, and convert visitors into customers.
      </p>
    </div>
  </section>

  <!-- Categories -->
  <section class="blog-categories">
    <div class="container">
      <div class="categories-nav">
        {categories.map((cat, i) => (
          <button class:list={['category-btn', { 'category-btn--active': i === 0 }]} data-category={cat}>
            {cat}
          </button>
        ))}
      </div>
    </div>
  </section>

  <!-- Posts Grid -->
  <section class="section">
    <div class="container">
      <div class="posts-grid">
        {blogPosts.map((post, index) => (
          <article class:list={['post-card', { 'post-card--featured': index === 0 }]} data-category={post.category}>
            <div class="post-image">
              <img src={post.image} alt={post.imageAlt} loading={index < 3 ? 'eager' : 'lazy'} />
            </div>
            <div class="post-content">
              <div class="post-meta">
                <span class="post-category">{post.category}</span>
                <span class="post-date">{new Date(post.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>
              </div>
              <h2 class="post-title">
                <a href={`/blog/${post.slug}/`}>{post.title}</a>
              </h2>
              <p class="post-excerpt">{post.excerpt}</p>
              <div class="post-footer">
                <span class="post-read-time">{post.readTime}</span>
                <a href={`/blog/${post.slug}/`} class="post-link">
                  Read More
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <path d="M3.33 8h9.34M8.67 4l4 4-4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <section class="section section-alt">
    <div class="container">
      <div class="newsletter-box">
        <h2>Get SEO Tips in Your Inbox</h2>
        <p>Join thousands of business owners getting weekly SEO insights and strategies.</p>
        <form class="newsletter-form" action="/api/newsletter" method="POST">
          <input type="email" name="email" placeholder="Enter your email" required class="form-input" />
          <button type="submit" class="btn btn-primary">Subscribe</button>
        </form>
        <p class="newsletter-note">No spam. Unsubscribe anytime.</p>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <CTASection 
    heading="Need Help With Your SEO?"
    subheading="Get matched with SEO experts who can help your business rank higher and grow."
    buttonText="Get Free Strategy"
  />
</BaseLayout>

<script>
  const categoryBtns = document.querySelectorAll('.category-btn');
  const postCards = document.querySelectorAll('.post-card');
  
  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      // Update active state
      categoryBtns.forEach(b => b.classList.remove('category-btn--active'));
      btn.classList.add('category-btn--active');
      
      const category = btn.dataset.category;
      
      // Filter posts
      postCards.forEach(card => {
        if (category === 'All' || card.dataset.category === category) {
          card.style.display = '';
        } else {
          card.style.display = 'none';
        }
      });
    });
  });
</script>

<style>
  .blog-hero {
    padding: var(--space-16) 0;
    background: linear-gradient(180deg, #f8fafc 0%, white 100%);
    text-align: center;
  }
  
  .blog-hero h1 {
    font-size: var(--text-4xl);
    margin-bottom: var(--space-4);
  }
  
  @media (min-width: 768px) {
    .blog-hero h1 {
      font-size: var(--text-5xl);
    }
  }
  
  .blog-hero-subtitle {
    font-size: var(--text-lg);
    color: var(--color-text-light);
    max-width: 600px;
    margin: 0 auto;
  }
  
  /* Categories */
  .blog-categories {
    padding: var(--space-6) 0;
    border-bottom: 1px solid var(--color-border-light);
  }
  
  .categories-nav {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    justify-content: center;
  }
  
  .category-btn {
    padding: var(--space-2) var(--space-4);
    background: transparent;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-text-light);
    cursor: pointer;
    transition: all var(--transition-fast);
  }
  
  .category-btn:hover,
  .category-btn--active {
    background: var(--color-primary);
    border-color: var(--color-primary);
    color: white;
  }
  
  /* Posts Grid */
  .posts-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-8);
  }
  
  @media (min-width: 768px) {
    .posts-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .post-card--featured {
      grid-column: span 2;
    }
  }
  
  @media (min-width: 1024px) {
    .posts-grid {
      grid-template-columns: repeat(3, 1fr);
    }
    
    .post-card--featured {
      grid-column: span 2;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--space-6);
    }
  }
  
  .post-card {
    background: white;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    transition: transform var(--transition-base), box-shadow var(--transition-base);
  }
  
  .post-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }
  
  .post-image {
    aspect-ratio: 16 / 9;
    overflow: hidden;
  }
  
  .post-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .post-card--featured .post-image {
    aspect-ratio: auto;
    min-height: 100%;
  }
  
  .post-content {
    padding: var(--space-6);
  }
  
  .post-meta {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
  }
  
  .post-category {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .post-date {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
  }
  
  .post-title {
    font-size: var(--text-xl);
    margin-bottom: var(--space-3);
    line-height: 1.3;
  }
  
  .post-card--featured .post-title {
    font-size: var(--text-2xl);
  }
  
  .post-title a {
    color: var(--color-secondary);
    text-decoration: none;
  }
  
  .post-title a:hover {
    color: var(--color-primary);
  }
  
  .post-excerpt {
    color: var(--color-text-light);
    font-size: var(--text-sm);
    line-height: 1.6;
    margin-bottom: var(--space-4);
  }
  
  .post-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .post-read-time {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
  }
  
  .post-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--color-primary);
  }
  
  /* Newsletter */
  .newsletter-box {
    max-width: 500px;
    margin: 0 auto;
    text-align: center;
  }
  
  .newsletter-box h2 {
    margin-bottom: var(--space-3);
  }
  
  .newsletter-box > p {
    color: var(--color-text-light);
    margin-bottom: var(--space-6);
  }
  
  .newsletter-form {
    display: flex;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
  }
  
  .newsletter-form .form-input {
    flex: 1;
  }
  
  .newsletter-note {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    margin: 0;
  }
  
  @media (max-width: 480px) {
    .newsletter-form {
      flex-direction: column;
    }
  }
</style>
